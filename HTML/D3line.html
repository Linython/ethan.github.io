<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="text" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>D3.js plot</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.21.0/d3-legend.min.js"></script>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/test0124.css">
    <link rel="shortcut icon" href="./Html_img/favicon.ico">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        let data01 = [[0, 15.28],[1, 15.59],[2, 15.74],[3, 15.5],[4, 15.67],[5, 15.29],[6, 15.28],[7, 15.58],[8, 15.31],[9, 15.98],[10, 15.61],[11, 15.42],[12, 15.18],[13, 15.53],[14, 15.37],[15, 15.1],[16, 15.4],[17, 15.67],[18, 15.18],[19, 15.46],[20, 15.33],[21, 15.38],[22, 15.27],[23, 15.34],[24, 15.57],[25, 15.58]]
        let data02 = [[0, 18.27],[1, 18.05],[2, 18.16],[3, 17.54],[4, 17.13],[5, 18.26],[6, 17.55],[7, 17.82],[8, 17.75],[9, 17.65],[10, 17.35],[11, 18.52],[12, 17.79],[13, 17.05],[14, 17.06],[15, 18.52],[16, 18.48],[17, 18.07],[18, 18.36],[19, 18.78],[20, 19.0],[21, 18.68],[22, 17.05],[23, 18.09],[24, 18.7],[25, 17.22]]
        let data03 = [[0, 20.60],[1, 16.06],[2, 22.47],[3, 17.15],[4, 22.67],[5, 22.68],[6, 16.77],[7, 22.51],[8, 21.0],[9, 21.04],[10, 18.37],[11, 17.69],[12, 19.16],[13, 20.04],[14, 16.21],[15, 22.61],[16, 17.89],[17, 18.83],[18, 20.26],[19, 16.9],[20, 21.58],[21, 22.49],[22, 18.06],[23, 21.32],[24, 21.94],[25, 16.7]]
        let data04 = [[0, 20.66],[1, 20.38],[2, 20.73],[3, 19.08],[4, 18.6],[5, 21.22],[6, 18.31],[7, 18.74],[8, 21.49],[9, 21.73],[10, 19.32],[11, 20.25],[12, 19.67],[13, 18.99],[14, 19.91],[15, 19.16],[16, 18.63],[17, 21.69],[18, 19.19],[19, 21.81],[20, 18.34],[21, 19.66],[22, 21.26],[23, 18.36],[24, 21.09],[25, 21.86]]
        let data05 = [[0, 17.66],[1, 17.65],[2, 17.42],[3, 17.7],[4, 17.81],[5, 17.21],[6, 17.12],[7, 17.76],[8, 17.48],[9, 17.03],[10, 17.15],[11, 17.46],[12, 17.98],[13, 17.92],[14, 17.06],[15, 17.44],[16, 17.52],[17, 17.88],[18, 17.39],[19, 17.64],[20, 17.65],[21, 17.21],[22, 17.63],[23, 17.41],[24, 17.25],[25, 17.95]]
        let data06 = [[0, 18.57],[1, 17.40],[2, 18.08],[3, 17.94],[4, 20.57],[5, 18.2],[6, 20.01],[7, 19.68],[8, 17.43],[9, 19.96],[10, 19.97],[11, 17.77],[12, 19.65],[13, 20.25],[14, 19.3],[15, 18.58],[16, 19.19],[17, 17.13],[18, 18.05],[19, 17.83],[20, 19.25],[21, 20.77],[22, 19.16],[23, 20.58],[24, 19.06],[25, 19.13]]
        let data07 = [[0, 19.05],[1, 20.57],[2, 20.84],[3, 16.6],[4, 17.1],[5, 20.66],[6, 20.92],[7, 20.73],[8, 18.46],[9, 17.62],[10, 21.88],[11, 17.74],[12, 20.99],[13, 17.49],[14, 17.18],[15, 20.19],[16, 21.08],[17, 16.76],[18, 18.76],[19, 22.53],[20, 19.25],[21, 20.79],[22, 21.83],[23, 16.64],[24, 19.88],[25, 16.68]]
        let data08 = [[0, 19.36],[1, 19.6],[2, 18.21],[3, 19.34],[4, 18.39],[5, 19.66],[6, 19.9],[7, 18.16],[8, 22.0],[9, 21.11],[10, 19.72],[11, 18.96],[12, 20.97],[13, 19.01],[14, 18.68],[15, 20.0],[16, 19.19],[17, 19.56],[18, 19.42],[19, 20.87],[20, 18.01],[21, 21.43],[22, 18.63],[23, 20.22],[24, 20.23],[25, 20.88]]
        let data09 = [[0, 13.62],[1, 13.79],[2, 13.13],[3, 13.89],[4, 13.73],[5, 13.19],[6, 13.08],[7, 13.04],[8, 13.09],[9, 13.05],[10, 13.05],[11, 13.65],[12, 13.21],[13, 13.98],[14, 13.13],[15, 13.63],[16, 13.94],[17, 13.43],[18, 13.45],[19, 13.04],[20, 13.78],[21, 13.83],[22, 13.61],[23, 13.15],[24, 13.9],[25, 13.81]]
        let data10 = [[0, 16.84],[1, 16.5],[2, 16.38],[3, 16.08],[4, 16.41],[5, 16.53],[6, 16.07],[7, 16.38],[8, 16.79],[9, 16.18],[10, 16.61],[11, 16.92],[12, 16.22],[13, 16.97],[14, 16.71],[15, 16.93],[16, 16.33],[17, 16.63],[18, 16.69],[19, 16.32],[20, 16.98],[21, 16.13],[22, 16.87],[23, 16.55],[24, 16.25],[25, 16.59]]
        let data11 = [[0, 22.52],[1, 22.8],[2, 22.52],[3, 22.91],[4, 22.15],[5, 22.75],[6, 22.42],[7, 22.44],[8, 22.2],[9, 22.52],[10, 22.9],[11, 22.84],[12, 22.43],[13, 22.66],[14, 22.66],[15, 22.51],[16, 22.33],[17, 22.46],[18, 22.71],[19, 22.5],[20, 22.49],[21, 22.33],[22, 22.79],[23, 22.0],[24, 22.25],[25, 22.26]]
        let data12 = [[0, 20.74],[1, 21.52],[2, 20.62],[3, 21.84],[4, 20.02],[5, 20.91],[6, 20.24],[7, 20.29],[8, 20.15],[9, 20.47],[10, 20.64],[11, 21.6],[12, 21.39],[13, 21.13],[14, 21.02],[15, 21.92],[16, 21.62],[17, 21.27],[18, 21.26],[19, 20.98],[20, 20.14],[21, 20.91],[22, 20.73],[23, 21.76],[24, 21.03],[25, 20.98]]
        let data13 = [[0, 22.45],[1, 22.58],[2, 22.65],[3, 21.02],[4, 20.1],[5, 20.74],[6, 21.52],[7, 22.02],[8, 22.93],[9, 21.98],[10, 20.25],[11, 20.45],[12, 20.65],[13, 22.66],[14, 21.15],[15, 20.88],[16, 21.93],[17, 20.3],[18, 20.45],[19, 21.55],[20, 22.24],[21, 21.47],[22, 20.68],[23, 22.23],[24, 22.59],[25, 21.51]]
        let data14 = [[0, 23.63],[1, 22.77],[2, 22.83],[3, 19.32],[4, 18.61],[5, 21.2],[6, 20.69],[7, 20.06],[8, 18.63],[9, 21.97],[10, 23.74],[11, 19.11],[12, 20.31],[13, 18.06],[14, 18.12],[15, 22.5],[16, 20.22],[17, 18.69],[18, 22.45],[19, 23.02],[20, 23.31],[21, 20.86],[22, 19.94],[23, 22.45],[24, 21.96],[25, 23.08]]
        // 数据点形状设置
        let tri = d3.symbol().type(d3.symbolTriangle).size(50)
        cir = d3.symbol().type(d3.symbolCircle)
        cro = d3.symbol().type(d3.symbolCross).size(50)
        dia = d3.symbol().type(d3.symbolDiamond).size(50)
        sta = d3.symbol().type(d3.symbolStar).size(50)
        // pic函数用于绘制图片的坐标轴
        function pic(max, min, xTitle, yTitle) {
            // 图表的宽度和高度
            let width = 750;
            let height = 550;
            // 边距
            let padding = {top: 50, right: 100, bottom: 50, left: 50};
            // 绘制坐标抽
            let xScale = d3.scaleLinear()
              .domain([0, 25])
              .range([0, 500]);
            let yScale = d3.scaleLinear()
              .domain([min, max])
              .range([height - padding.top - padding.bottom, 0]);
            let svg = d3.select('div')
              .append('svg')
              .attr('width', width + 'px')
              .attr('height', height + 'px');
            let xAxis = d3.axisBottom()
              .ticks(25) // 显示刻度的数量，即步长。
              .scale(xScale);
            let yAxis = d3.axisLeft()
              .ticks(10)
              .scale(yScale);

            svg.append('g')
              .attr('class', 'axis')
              .attr('transform', 'translate(' + padding.left + ',' + (height - padding.bottom) + ')')
              .call(xAxis);

            svg.append('g')
              .attr('class', 'axis')
              .attr('transform', 'translate(' + padding.left + ',' + padding.top + ')')
              .call(yAxis);

            let linePath = d3.line()
              .x(function (d) {
                  return xScale(d[0])
              })
              .y(function (d) {
                  return yScale(d[1])
              });

            //增加一个x轴的标签
            svg.append("text")
              .attr("transform", "translate(" + (width-300) / 2 + "," + (height - padding.bottom + 40) + ")")
              .style("text-anchor", "middle")
              .style('font-size', '20px')
              .attr('fill', 'black')
              .text(xTitle);
            //添加y轴
            svg.append("text")
              .text(yTitle)
              .style("font-size", "20px")
              .style("text-anchor", "start")
              .attr("transform", "rotate(-90 200 180)");
            return {
                lines: function (data, color, legend, color_line, name, x, y, class_legend) {
                  svg.append('g')
                      .append('path')
                      .attr('class', 'line-path')
                      .attr('transform', 'translate(' + padding.left + ',' + padding.top + ')')
                      .attr('d', linePath(data))
                      .attr('fill', 'none')
                      .attr('stroke-width', 1)
                      .attr('stroke', color);
                  svg.append('g')
                      .selectAll('.triangle')
                      .data(data)
                      .enter()
                      .append('path')
                      .attr('d', legend.size(50))
                      .attr('class', 'point')
                      .attr('transform', function (d) {
                          return 'translate(' + (xScale(d[0]) + padding.left) + ',' + (yScale(d[1]) + padding.top) + ')';
                      })
                      .attr('fill', color)
                      .attr('class', color_line)

                  let a = "." + color_line
                  svg.selectAll(a)
                      .on("mouseover", function (d, i) {
                          d3.select(this)
                              .attr("fill", "red")
                              .attr("d", legend.size(120))
                          svg.append('text')
                              .text(i[1])
                              .attr('class', 'tooltip1')
                              .attr('x', xScale(i[0]) + 40)
                              .attr('y', yScale(i[1]) + 35)
                              .attr("font-family", "sans-serif")
                              .attr("font-size", "11px")
                              .attr("fill", "red")
                      })
                      .on("mouseout", function () {
                          d3.select(this)
                              .attr("fill", color)
                              .attr('d', legend.size(50))
                          d3.select('.tooltip1').remove()
                      });
                  let ordinal1 = d3.scaleOrdinal()
                      .domain([name])
                      .range([color]);
                  svg.append('g')
                      .attr('class', class_legend)
                      .attr('transform', 'translate(' + x + ',' + y + ')');
                  let leg_tri = d3.legendColor()
                      .shapePadding(10)
                      .scale(ordinal1);
                  let b = "." + class_legend
                  svg.select(b)
                      .call(leg_tri);
                }
            }
            }
    </script>
</head>
<body>
    <div id="all">
        <div class="input-data">
            <div class="input-data-text">
                <div class="input-data-text1">
                    <label for="xTitle" class="input-text">xTitle:</label><br>
                    <label><input type="text" id="xTitle" name="xTitle" value="Day"></label><br>
                </div>
                <div class="input-data-text2" id="ads">
                    <label for="yTitle" class="input-text">yTitle: </label><br>
                    <label><input type="text" id="yTitle" name="yTitle" value="Weight (g)"></label><br>
                </div>
            </div>
            <div class="input-data-num">
                <div class="input-data-num1">
                    <label for="x_min" class="input-text">xScale(min): </label><br>
                    <label><input type="number" id="x_min" name="xScale" min="0" max="100" value="15" step="0.2"></label>
                </div>
                <div><br>~</div>
                <div class="input-data-num2">
                    <label for="x_max" class="input-text">xScale(max): </label><br>
                    <label><input type="number" id="x_max" name="xScale" min="10" max="100" value="25" step="0.2"></label><br>
                </div>
                <div class="input-data-num3">
                    <label for="y_min" class="input-text">yScale(min): </label><br>
                    <label><input type="number" id="y_min" name="yScale" min="-50" max="100" value="10" step="0.2"></label>
                </div>
                <div><br>~</div>
                <div class="input-data-num4">
                    <label for="y_max" class="input-text">yScale(max): </label><br>
                    <label><input type="number" id="y_max" name="xScale" min="10" max="100" value="25" step="0.2"></label><br>
                </div>
            </div>
        </div>
        <div class="select">
            <span style="font-size: 25px">Select and drawing:</span><br>
            <script>
                function fun(){
                    let data_array = []
                    let v=document.getElementsByName('checkbox')
                    for (let i=0; i<v.length; i++){
                        if (v[i].checked){
                            let select_value =  v[i].value
                            data_array.push({
                                key: i,
                                value: select_value
                            })
                        }
                    }
                    return data_array
                }
                function WT010(max = document.querySelector("#y_max").value, min = document.querySelector("#y_min").value, xTitle = document.querySelector('#xTitle').value, yTitle=document.querySelector('#yTitle').value) {
                    d3.select('svg').remove()
                    let a1 = pic(max, min, xTitle, yTitle) // 绘制坐标轴系统
                    function data_list() {
                        let data_array = fun();
                        let legend_y = 110;
                        let data;
                        let color;
                        let legend;
                        let color_line;
                        let x;
                        let y;
                        let class_legend;
                        for (let i=0; i<data_array.length; i++){
                            if (data_array[i].value === 'BBR01'){
                                a1.lines(data=data01, '#41555d', tri, 'grey_line', name = 'BBR01', x = 600, y = legend_y+i*20, 'tri')} //添加折线
                            else if (data_array[i].value === 'BBR02'){
                                a1.lines(data= data02, '#2edfa3', cir, 'blue_line', name = 'BBR02', x = 600, y = legend_y+i*20, 'cir')}
                            else if (data_array[i].value === 'BBR03'){
                                a1.lines(data = data03, '#00aee6', cro, 'gb_line', name = 'BBR03', x = 600, y = legend_y+i*20, 'cro')}
                            else if (data_array[i].value === 'BBR04'){
                                a1.lines(data= data04, '#8e43e7', dia, 'a43e7', name = 'BBR04', x = 600, y = legend_y+i*20, 'dia')}
                            else if (data_array[i].value === 'BBR05'){
                                a1.lines(data= data05, color='#f36838', legend=dia, color_line='c2368', name='BBR05', x=600, y=legend_y+i*20, class_legend='dia1')}
                            else if (data_array[i].value === 'BBR06'){
                                a1.lines(data= data06, color='#bce672', legend=dia, color_line='bce67', name='BBR06', x=600, y=legend_y+i*20, class_legend='dia2')}
                            else if (data_array[i].value === 'BBR07'){
                                a1.lines(data=data07, color = '#00aee6', legend = cro, color_line = 'aee6n', name = 'BBR07', x = 600, y = legend_y+i*20, class_legend = 'cro1')}
                            else if (data_array[i].value === 'BBR08'){
                                a1.lines(data=data08, color='#99CC99', legend=cir, color_line='ff99c', name='BBR08', x=600, y=legend_y+i*20, class_legend='cir2')}
                            else if (data_array[i].value === 'BBR09'){
                                a1.lines(data=data09, color='#db5a6b', legend=cro, color_line='db5a6', name='BBR09', x=600, y=legend_y+i*20, class_legend='cro2')}
                            else if (data_array[i].value === 'BBR10'){
                                a1.lines(data=data10, color='#425066', legend=dia, color_line='c4250', name='BBR10', x=600, y=legend_y+i*20, class_legend='dia3')}
                            else if (data_array[i].value === 'BBR11'){
                                a1.lines(data=data11, color='#789262', legend=dia, color_line='c2345', name='BBR11', x=600, y=legend_y+i*20, class_legend='dia4')}
                            else if (data_array[i].value === 'BBR12'){
                                a1.lines(data=data12, color='#8e43e7', legend=tri, color_line='e43a7', name='BBR12', x=600, y=legend_y+i*20, class_legend='tri2')}
                            else if (data_array[i].value === 'BBR13'){
                                a1.lines(data=data13, color='#99CC99', legend=cir, color_line='ff9cc', name='BBR13', x=600, y=legend_y+i*20, class_legend='cir3')}
                            else if (data_array[i].value === 'BBR14'){
                                a1.lines(data=data14, color='#db5a6b', legend=cro, color_line='db5ab', name='BBR14', x=600, y=legend_y+i*20, class_legend='cro3')}
                        }
                    }
                    data_list()
                }
            </script>
            <!--    在button标签中将绘图函数与其链接-->
            <button type="button" id="select" onclick="WT010()" >Drawing</button>
            <button type="button" id="clean" onclick=d3.select('svg').remove()>Clean</button>
        </div>
        <div class="box">
            <ul id="select-box">
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR01" value="BBR01"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR02" value="BBR02"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR03" value="BBR03"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR04" value="BBR04"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR05" value="BBR05"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR06" value="BBR06"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR07" value="BBR07"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR08" value="BBR08"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR09" value="BBR09"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR10" value="BBR10"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR11" value="BBR11"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR12" value="BBR12"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR13" value="BBR13"></label></li>
                <li><label><input type="checkbox" name="checkbox" data-labelauty="BBR14" value="BBR14"></label></li>
            </ul>
        </div>
    </div>
    <script src="js/jquery-labelauty.js"></script>
    <script>
        $(function(){
            $(':input').labelauty();
        });
    </script>
</body>
</html>